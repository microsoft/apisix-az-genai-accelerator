# Environment-specific tfvars for 20-workload (prod)

subscription_id = "00000000-0000-0000-0000-000000000000"
tenant_id       = "11111111-1111-1111-1111-111111111111"

environment_code = "prod"
location         = "eastus"
workload_name    = "apisix"
identifier       = ""

platform_resource_group_name = "rg-platform-apisix-prod-eastus"
platform_acr_name            = "acrplatformapisixprodeastus"
key_vault_name               = "kv-apisix-prod-eastus"
aca_managed_identity_id      = "/subscriptions/.../resourceGroups/.../providers/Microsoft.ManagedIdentity/userAssignedIdentities/aca-kv"

state_resource_group_name  = "rg-terraform-state"
state_storage_account_name = "stterraformstate123"
state_container_name       = "tfstate"
foundation_state_blob_key  = "prod/10-platform.tfstate"
openai_state_blob_key      = "prod/15-foundry.tfstate"

app_settings = {
  APISIX_LOG_LEVEL         = "warn"
  GATEWAY_REQUIRE_AUTH     = "true"
  OTEL_SAMPLE_RATE         = "0.1"
  ENABLE_DEBUG_EXPORTER    = "false"
  AI_PROXY_CONNECT_TIMEOUT = "3"
  AI_PROXY_SEND_TIMEOUT    = "120"
  AI_PROXY_READ_TIMEOUT    = "120"
  AI_PROXY_LOG_SUMMARIES   = "false"
}

secret_names = [
  "gateway-client-key-0",
  "azure-openai-key-0",
]

direct_environment_variables = {}

gateway_image = "acrplatformapisixprodeastus.azurecr.io/apisix-az-genai-accelerator/gateway:latest"
hydrenv_image = "acrplatformapisixprodeastus.azurecr.io/apisix-az-genai-accelerator/hydrenv:latest"

expose_gateway_public = true
gateway_target_port   = 9080
gateway_cpu           = 1.75
gateway_memory        = "3.5Gi"
gateway_min_replicas  = 2
gateway_max_replicas  = 10

otel_collector_cpu    = 0.25
otel_collector_memory = "0.5Gi"

log_analytics_workspace_id     = ""
log_retention_days             = 60
app_insights_connection_string = "InstrumentationKey=...;IngestionEndpoint=https://..."

enable_alerts         = true
alert_action_group_id = ""

tags = {
  owner       = "platform-team"
  environment = "prod"
  workload    = "apisix"
}
